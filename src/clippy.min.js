(function(e){var a=function(j){var k=j;if(!document.getElementsByTagName("body")[0]){setTimeout(function(){a(k)},10)}else{k()}};var d={base:"_",cur:0,get:function(){this.cur++;return this.base+this.cur}};var c=function(l,k){for(var j in k){l.style[j]=k[j]}};var i=function(k,j){k.appendChild(j)};var b=function(j,k){this.question=j;this.options=[];this.key=d.get();this.views=0;this.reusable=(k===true);this.timeout={};this.available=function(){return(this.views<1||this.reusable===true)};this.addResponseURL=function(m,l){this.options.push({text:m,URL:l,rel:"external"});return};this.addResponse=function(m,l){this.options.push({text:m,callback:l,rel:"internal"});return};this.addTimeout=function(m,l){this.timeout={callback:l,timeout:m}};this.getKey=function(){return this.key};this.toString=function(){return this.getKey()};this.toElements=function(){this.views++;var q=document.createElement("div");var o=document.createElement("p");o.innerHTML=this.question;i(q,o);for(var m=0;m<this.options.length;m++){var l=document.createElement("button");l.innerHTML=this.options[m].text;if(this.options[m].rel=="internal"){l.onclick=this.options[m].callback}else{var n=this.options[m];l.onclick=function(){e.location=n.URL}}i(q,l)}if(this.timeout.callback&&typeof(this.timeout.callback)=="function"){setTimeout(this.timeout.callback,(this.timeout.timeout?this.timeout.timeout:500))}return q};return this};var h=function(k){this.file_dir=(k.file_dir)?k.file_dir:"";this.div=document.createElement("div");c(this.div,{zIndex:1000000,width:"102px",height:"98px",backgroundColor:"transparent",position:"absolute",bottom:0,color:"black",right:"60px",display:"block"});var j=new Image();j.src=this.file_dir+"clippy-main.png";j.style.position="relative";j.style.display="block";i(this.div,j);this.div.style.opacity=(k.visible===false)?0:1;if(k.click&&typeof(k.click)=="function"){j.onclick=k.click}this.getElement=function(){return this.div||null};this.getPosition=function(){return{bottom:this.div.style.bottom,right:this.div.style.right}};this.fadeIn=function(m,l){var n=this;if(!l){l={}}if(!l.step){l.step=1/200}if(!l.value){l.value=0}if(!l.remain){l.remain=200}if(!l.increment){l.increment=m/200}l.remain--;l.value+=l.step;n.div.style.opacity=l.value;if(l.remain>0){setTimeout(function(){n.fadeIn(m,l)},l.increment)}return};this.move=function(l,m){c(this.div,{bottom:(parseInt(this.div.style.top)+l)+"px",right:(parseInt(this.div.style.left)+m)+"px"})};return this};var f=function(m,k){this.file_dir=k.file_dir||"";if(typeof(m)==="string"){p=document.createElement("p");p.innerHTML=m;m=p}this.div=document.createElement("div");c(this.div,{zIndex:1000000,width:"130px",height:"auto",backgroundColor:"transparent",color:"black",position:"absolute",bottom:"85px",right:"55px",display:"block"});var l=new Image();l.src=this.file_dir+"clippy-speech-top.png";c(l,{position:"relative",display:"block"});i(this.div,l);this.message=document.createElement("div");this.message.style.background="transparent url('"+this.file_dir+"clippy-speech-mid.png') top left repeat-y";this.message.style.padding="8px";this.message.style.font="11.5px Arial, Verdana, Sans";i(this.message,m);i(this.div,this.message);var j=new Image();j.src=this.file_dir+"clippy-speech-bottom.png";c(j,{position:"relative",display:"block"});i(this.div,j);this.close=function(){try{var o=this.getElement();if(o!=null&&o.parentNode){o=o.parentNode;o.removeChild(this.getElement())}}catch(n){}};this.getElement=function(){return this.div};return this};var g=function(k,j){this.help={};this.firstlines=[];this.homebase;this.timer=false;this.timer_interval=200;this.update_count=0;this.file_dir=j||"";this.preload=function(){var m=["clippy-main.png","clippy-speech-top.png","clippy-speech-mid.png","clippy-speech-bottom.png"];var l=[];for(var n in m){l[n]=new Image();l[n].onload=function(){};l[n].src=this.file_dir+m[n]}};this.findHomeBase=function(l){if(!l){l="body"}l+="";var m=false;if(l.substr(0,1)=="#"){m=document.getElementById(l.substr(1,l.length));var n=document.createElement("div");n.style.position="relative";i(m,n);return n}else{m=document.getElementsByTagName(l)[0];var n=document.createElement("div");c(n,{zIndex:9999999,width:"300px",height:"300px",backgroundColor:"transparent",position:"fixed",bottom:"0",right:"0"});i(m,n);return n}return m};this.run=function(m){if(!(m&&m.override&&m.override==true)){if(!(/MSIE 6/i.test(navigator.userAgent))){return false}}var t=this;this.character=new h({click:function(){t.say([x,w,u]);t.move(parseInt(Math.random()*20+-20),parseInt(Math.random()*20+-20))},file_dir:this.file_dir,visible:false});i(this.homebase,this.character.getElement());this.character.fadeIn(1000);var v=new b("I see you're trying to <i>use the internet.</i>  Would you like a friendly suggestion to make your browsing experience a more enjoyable and secure?");v.addResponse("Yes",function(){t.say([o,r,y],q)});v.addResponse("No",function(){t.talkLater()});this.addHelp(v,true);var n=new b("I see you're still <i>using IE6.</i>  That browser was released back in 2001, when strange beasts roamed the earth.<br><br>Would you like some upgrade suggestions?");n.addResponse("Yes",function(){t.say([o,r,y],q)});n.addResponse("No",function(){t.talkLater()});this.addHelp(n,true);var l=new b("Your current browser is out of date.<br><br>Can I show you some alternatives you might like better?");l.addResponse("Yes",function(){t.say([o,r,y],q)});l.addResponse("No",function(){t.talkLater()});this.addHelp(l,true);var s=new b("Would you like to try a more modern browser?");s.addResponse("Yes",function(){t.say([o,r,y],q)});s.addResponse("No",function(){t.talkLater()});this.addHelp(s,true);var o=new b("<b>Firefox</b> is a great standards compliant browser from Mozilla that is also free and open source!<br><br>Want to try it?");o.addResponseURL("Yes","http://www.firefox.com");o.addResponse("No",function(){t.say([r,y],q)});this.addHelp(o);var r=new b("<b>Chrome</b> is lightweight fast browser developed by Google!<br><br>Want to try it?");r.addResponseURL("Yes","http://www.google.com/chrome");r.addResponse("No",function(){t.say([o,y],q)});this.addHelp(r);var y=new b("<b>Opera</b> is a browser focused on speed and memory usage.  Lots of people like it.<br><br>Want to give it a try?");y.addResponseURL("Yes","http://www.opera.com");y.addResponse("No",function(){t.say([o,r],q)});this.addHelp(y);var q=new b("I hope you change your mind someday!");q.addTimeout(1000,function(){t.closeBubble()});this.addHelp(q);var x=new b("Ouch!",true);x.addTimeout(1000,function(){t.closeBubble()});this.addHelp(x);var w=new b("Ahhh My Face!!",true);w.addTimeout(1000,function(){t.closeBubble()});this.addHelp(w);var u=new b("Don't hurt me no more!",true);u.addTimeout(1000,function(){t.closeBubble()});this.addHelp(u);this.talkLater(2000)};this.addHelp=function(l,m){this.help[l.getKey()]=l;if(m){this.firstlines.push(l.getKey())}return};this.sayOne=function(o,m){var q=false,n=0;while(n<o.length){var l=parseInt(Math.random()*o.length);if(this.canSay(o[l])){this.say(o[l]);return}n++}if(m){this.say(m)}return};this.canSay=function(l){return this.help[l].available()};this.say=function(m,l){if(this.timer!=false){try{clearTimeout(this.timer);this.timer=false}catch(n){}}if(typeof(m)!=="string"&&m.length){this.sayOne(m,l)}if(this.help[m]){this.openBubble(this.help[m].toElements())}};this.firstLine=function(){this.sayOne(this.firstlines)};this.talkLater=function(m){this.closeBubble();var l=this;this.timer=setTimeout(function(){l.firstLine()},m?m:(Math.random()*3000+500))};this.openBubble=function(l){if(typeof(l)=="string"){var m=document.createElement("p");m.innerHTML=l}else{var m=l}if(this.bubble){this.bubble.close()}this.bubble=new f(m,{file_dir:this.file_dir});i(this.homebase,this.bubble.getElement())};this.closeBubble=function(){if(this.bubble){this.bubble.close()}};this.update=function(){this.update_count++};this.move=function(l,m){this.character.move(l,m)};this.homebase=this.findHomeBase(k);this.preload()};e.Clippy=g;e.__clippyboot=a})(window);