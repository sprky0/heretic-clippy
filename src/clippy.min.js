(function(d){var e=function(i){var j=i;if(!document.getElementsByTagName("body")[0]){setTimeout(function(){e(j)},10)}else{j()}};var g={base:"_",cur:0,get:function(){this.cur++;return this.base+this.cur}};var b=function(l,k){for(var j in k){l.style[j]=k[j]}};var c=function(i,j){this.question=i;this.options=[];this.key=g.get();this.views=0;this.reusable=(j===true);this.timeout={};this.available=function(){return(this.views<1||this.reusable===true)};this.addResponseURL=function(l,k){this.options.push({text:l,URL:k,rel:"external"});return};this.addResponse=function(l,k){this.options.push({text:l,callback:k,rel:"internal"});return};this.addTimeout=function(l,k){this.timeout={callback:k,timeout:l}};this.getKey=function(){return this.key};this.toString=function(){return this.getKey()};this.toElements=function(){this.views++;var o=document.createElement("div");var n=document.createElement("p");n.innerHTML=this.question;o.appendChild(n);for(var l=0;l<this.options.length;l++){var k=document.createElement("button");k.innerHTML=this.options[l].text;if(this.options[l].rel=="internal"){k.onclick=this.options[l].callback}else{var m=this.options[l];k.onclick=function(){d.location=m.URL}}o.appendChild(k)}if(this.timeout.callback&&typeof(this.timeout.callback)=="function"){setTimeout(this.timeout.callback,(this.timeout.timeout?this.timeout.timeout:500))}return o};return this};var h=function(j){this.file_dir=(j.file_dir)?j.file_dir:"";this.div=document.createElement("div");b(this.div,{zIndex:1000000,width:"102px",height:"98px",backgroundColor:"transparent",position:"absolute",bottom:0,color:"black",right:"60px",display:"block"});var i=new Image();i.src=this.file_dir+"clippy-main.png";i.style.position="relative";i.style.display="block";this.div.appendChild(i);this.div.style.opacity=(j.visible===false)?0:1;if(j.click&&typeof(j.click)=="function"){i.onclick=j.click}this.getElement=function(){return this.div||null};this.getPosition=function(){return{bottom:this.div.style.bottom,right:this.div.style.right}};this.fadeIn=function(l,k){var m=this;if(!k){k={}}if(!k.step){k.step=1/200}if(!k.value){k.value=0}if(!k.remain){k.remain=200}if(!k.increment){k.increment=l/200}k.remain--;k.value+=k.step;m.div.style.opacity=k.value;if(k.remain>0){setTimeout(function(){m.fadeIn(l,k)},k.increment)}return};this.move=function(k,l){b(this.div,{bottom:(parseInt(this.div.style.top)+k)+"px",right:(parseInt(this.div.style.left)+l)+"px"})};return this};var a=function(l,j){this.file_dir=(j.file_dir)?j.file_dir:"";if(typeof(l)==="string"){p=document.createElement("p");p.innerHTML=l;l=p}this.div=document.createElement("div");b(this.div,{zIndex:1000000,width:"130px",height:"auto",backgroundColor:"transparent",color:"black",position:"absolute",bottom:"85px",right:"55px",display:"block"});var k=new Image();k.src=this.file_dir+"clippy-speech-top.png";k.style.position="relative";k.style.display="block";this.div.appendChild(k);this.message=document.createElement("div");this.message.style.background="transparent url('"+this.file_dir+"clippy-speech-mid.png') top left repeat-y";this.message.style.padding="8px";this.message.style.font="11.5px Arial, Verdana, Sans";this.message.appendChild(l);this.div.appendChild(this.message);var i=new Image();i.src=this.file_dir+"clippy-speech-bottom.png";i.style.position="relative";i.style.display="block";this.div.appendChild(i);this.close=function(){try{var n=this.getElement();if(n!=null&&n.parentNode){n=n.parentNode;n.removeChild(this.getElement())}}catch(m){}};this.getElement=function(){return this.div};return this};var f=function(j,i){this.help={};this.firstlines=[];this.homebase;this.timer=false;this.timer_interval=200;this.update_count=0;this.file_dir=i||"";this.preload=function(){var l=["clippy-main.png","clippy-speech-top.png","clippy-speech-mid.png","clippy-speech-bottom.png"];var k=[];for(var m in l){k[m]=new Image();k[m].onload=function(){};k[m].src=this.file_dir+l[m]}};this.findHomeBase=function(k){if(!k){k="body"}k+="";var l=false;if(k.substr(0,1)=="#"){l=document.getElementById(k.substr(1,k.length));var m=document.createElement("div");m.style.position="relative";l.appendChild(m);return m}else{l=document.getElementsByTagName(k)[0];var m=document.createElement("div");b(m,{zIndex:9999999,width:"300px",height:"300px",backgroundColor:"transparent",position:"fixed",bottom:"0",right:"0"});l.appendChild(m);return m}return l};this.run=function(l){if(!(l&&l.override&&l.override==true)){if(!(/MSIE 6/i.test(navigator.userAgent))){return false}}var s=this;this.character=new h({click:function(){s.say([w,v,t]);s.move(parseInt(Math.random()*20+-20),parseInt(Math.random()*20+-20))},file_dir:this.file_dir,visible:false});this.homebase.appendChild(this.character.getElement());this.character.fadeIn(1000);var u=new c("I see you're trying to <i>use the internet.</i>  Would you like a friendly suggestion to make your browsing experience a more enjoyable and secure?");u.addResponse("Yes",function(){s.say([n,q,x],o)});u.addResponse("No",function(){s.talkLater()});this.addHelp(u,true);var m=new c("I see you're still <i>using IE6.</i>  That browser was released back in 2001, when strange beasts roamed the earth.<br><br>Would you like some upgrade suggestions?");m.addResponse("Yes",function(){s.say([n,q,x],o)});m.addResponse("No",function(){s.talkLater()});this.addHelp(m,true);var k=new c("Your current browser is out of date.<br><br>Can I show you some alternatives you might like better?");k.addResponse("Yes",function(){s.say([n,q,x],o)});k.addResponse("No",function(){s.talkLater()});this.addHelp(k,true);var r=new c("Would you like to try a more modern browser?");r.addResponse("Yes",function(){s.say([n,q,x],o)});r.addResponse("No",function(){s.talkLater()});this.addHelp(r,true);var n=new c("<b>Firefox</b> is a great standards compliant browser from Mozilla that is also free and open source!<br><br>Want to try it?");n.addResponseURL("Yes","http://www.firefox.com");n.addResponse("No",function(){s.say([q,x],o)});this.addHelp(n);var q=new c("<b>Chrome</b> is lightweight fast browser developed by Google!<br><br>Want to try it?");q.addResponseURL("Yes","http://www.google.com/chrome");q.addResponse("No",function(){s.say([n,x],o)});this.addHelp(q);var x=new c("<b>Opera</b> is a browser focused on speed and memory usage.  Lots of people like it.<br><br>Want to give it a try?");x.addResponseURL("Yes","http://www.opera.com");x.addResponse("No",function(){s.say([n,q],o)});this.addHelp(x);var o=new c("I hope you change your mind someday!");o.addTimeout(1000,function(){s.closeBubble()});this.addHelp(o);var w=new c("Ouch!",true);w.addTimeout(1000,function(){s.closeBubble()});this.addHelp(w);var v=new c("Ahhh My Face!!",true);v.addTimeout(1000,function(){s.closeBubble()});this.addHelp(v);var t=new c("Don't hurt me no more!",true);t.addTimeout(1000,function(){s.closeBubble()});this.addHelp(t);this.talkLater(2000)};this.addHelp=function(k,l){this.help[k.getKey()]=k;if(l){this.firstlines.push(k.getKey())}return};this.sayOne=function(n,l){var o=false,m=0;while(m<n.length){var k=parseInt(Math.random()*n.length);if(this.canSay(n[k])){this.say(n[k]);return}m++}if(l){this.say(l)}return};this.canSay=function(k){return this.help[k].available()};this.say=function(l,k){if(this.timer!=false){try{clearTimeout(this.timer);this.timer=false}catch(m){}}if(typeof(l)!=="string"&&l.length){this.sayOne(l,k)}if(this.help[l]){this.openBubble(this.help[l].toElements())}};this.firstLine=function(){this.sayOne(this.firstlines)};this.talkLater=function(l){this.closeBubble();var k=this;this.timer=setTimeout(function(){k.firstLine()},l?l:(Math.random()*3000+500))};this.openBubble=function(k){if(typeof(k)=="string"){var l=document.createElement("p");l.innerHTML=k}else{var l=k}if(this.bubble){this.bubble.close()}this.bubble=new a(l,{file_dir:this.file_dir});this.homebase.appendChild(this.bubble.getElement())};this.closeBubble=function(){if(this.bubble){this.bubble.close()}};this.update=function(){this.update_count++};this.move=function(k,l){this.character.move(k,l)};this.homebase=this.findHomeBase(j);this.preload()};d.Clippy=f;d.__clippyboot=e})(window);