function __clippyboot(a){var b=a;if(!document.getElementsByTagName("body")[0]){setTimeout(function(){__clippyboot(b)},10)}else{b()}}var GUID={base:"_",cur:0,get:function(){this.cur++;return this.base+this.cur}};var HelpText=function(a,b){this.question=a;this.options=[];this.key=GUID.get();this.views=0;this.reusable=(b===true);this.timeout={};return this};HelpText.prototype.available=function(){return(this.views<1||this.reusable===true)};HelpText.prototype.addResponseURL=function(b,a){this.options.push({text:b,URL:a,rel:"external"});return};HelpText.prototype.addResponse=function(b,a){this.options.push({text:b,callback:a,rel:"internal"});return};HelpText.prototype.addTimeout=function(b,a){this.timeout={callback:a,timeout:b}};HelpText.prototype.getKey=function(){return this.key};HelpText.prototype.toString=function(){return this.question};HelpText.prototype.toString=function(){return this.getKey()};HelpText.prototype.toElements=function(){this.views++;var e=document.createElement("div");var d=document.createElement("p");d.innerHTML=this.question;e.appendChild(d);for(var b=0;b<this.options.length;b++){var a=document.createElement("button");a.innerHTML=this.options[b].text;if(this.options[b].rel=="internal"){a.onclick=this.options[b].callback}else{var c=this.options[b];a.onclick=function(){window.location=c.URL}}e.appendChild(a)}if(this.timeout.callback&&typeof(this.timeout.callback)=="function"){setTimeout(this.timeout.callback,(this.timeout.timeout?this.timeout.timeout:500))}return e};var ClippyDisplay=function(b){this.file_dir=(b.file_dir)?b.file_dir:"";this.div=document.createElement("div");this.div.style.zIndex=1000000;this.div.style.width="102px";this.div.style.height="98px";this.div.style.backgroundColor="transparent";this.div.style.position="absolute";this.div.style.bottom=0;this.div.style.color="black";this.div.style.right="60px";this.div.style.display="block";var a=new Image();a.src=this.file_dir+"clippy-main.png";a.style.position="relative";a.style.display="block";this.div.appendChild(a);this.div.style.opacity=(b.visible===false)?0:1;if(b.click&&typeof(b.click)=="function"){a.onclick=b.click}return this};ClippyDisplay.prototype.getElement=function(){return this.div||null};ClippyDisplay.prototype.getPosition=function(){return{bottom:this.div.style.bottom,right:this.div.style.right}};ClippyDisplay.prototype.fadeIn=function(b,a){var c=this;if(!a){a={}}if(!a.step){a.step=1/200}if(!a.value){a.value=0}if(!a.remain){a.remain=200}if(!a.increment){a.increment=b/200}a.remain--;a.value+=a.step;c.div.style.opacity=a.value;if(a.remain>0){setTimeout(function(){c.fadeIn(b,a)},a.increment)}return};ClippyDisplay.prototype.move=function(a,b){this.div.style.bottom=(parseInt(this.div.style.top)+a)+"px";this.div.style.right=(parseInt(this.div.style.left)+b)+"px"};var PopupDisplay=function(d,b){this.file_dir=(b.file_dir)?b.file_dir:"";if(typeof(d)==="string"){p=document.createElement("p");p.innerHTML=d;d=p}this.div=document.createElement("div");this.div.style.zIndex=1000000;this.div.style.width="130px";this.div.style.height="auto";this.div.style.backgroundColor="transparent";this.div.style.color="black";this.div.style.position="absolute";this.div.style.bottom="85px";this.div.style.right="55px";this.div.style.display="block";var c=new Image();c.src=this.file_dir+"clippy-speech-top.png";c.style.position="relative";c.style.display="block";this.div.appendChild(c);this.message=document.createElement("div");this.message.style.background="transparent url('"+this.file_dir+"clippy-speech-mid.png') top left repeat-y";this.message.style.padding="8px";this.message.style.font="11.5px Arial, Verdana, Sans";this.message.appendChild(d);this.div.appendChild(this.message);var a=new Image();a.src=this.file_dir+"clippy-speech-bottom.png";a.style.position="relative";a.style.display="block";this.div.appendChild(a);return this};PopupDisplay.prototype.close=function(){try{var b=this.getElement();if(b!=null&&b.parentNode){b=b.parentNode;b.removeChild(this.getElement())}}catch(a){}};PopupDisplay.prototype.getElement=function(){return this.div};var Clippy=function(b,a){this.help={};this.firstlines=[];this.homebase=this.findHomeBase(b);this.timer=false;this.timer_interval=200;this.update_count=0;this.file_dir=(a)?a:"";return this};Clippy.prototype.findHomeBase=function(a){if(!a){a="body"}a+="";var b=false;if((a).substr(0,1)=="#"){b=document.getElementById(a.substr(1,a.length));var c=document.createElement("div");c.style.position="relative";b.appendChild(c);return c}else{b=document.getElementsByTagName(a)[0];var c=document.createElement("div");c.style.zIndex=9999999;c.style.width="300px";c.style.height="300px";c.style.backgroundColor="transparent";c.style.position="fixed";c.style.bottom="0";c.style.right="0";b.appendChild(c);return c}return b};Clippy.prototype.run=function(b){if(!(b&&b.override&&b.override==true)){if(!(/MSIE 6/i.test(navigator.userAgent))){return false}}var h=this;this.character=new ClippyDisplay({click:function(){h.say([l,k,i]);h.move(parseInt(Math.random()*20+-20),parseInt(Math.random()*20+-20))},file_dir:this.file_dir,visible:false});this.homebase.appendChild(this.character.getElement());this.character.fadeIn(1000);var j=new HelpText("I see you're trying to <i>use the internet.</i>  Would you like a friendly suggestion to make your browsing experience a more enjoyable and secure?");j.addResponse("Yes",function(){h.say([d,f,m],e)});j.addResponse("No",function(){h.talkLater()});this.addHelp(j,true);var c=new HelpText("I see you're still <i>using IE6.</i>  That browser was released back in 2001, when strange beasts roamed the earth.<br><br>Would you like some upgrade suggestions?");c.addResponse("Yes",function(){h.say([d,f,m],e)});c.addResponse("No",function(){h.talkLater()});this.addHelp(c,true);var a=new HelpText("Your current browser is out of date.<br><br>Can I show you some alternatives you might like better?");a.addResponse("Yes",function(){h.say([d,f,m],e)});a.addResponse("No",function(){h.talkLater()});this.addHelp(a,true);var g=new HelpText("Would you like to try a more modern browser?");g.addResponse("Yes",function(){h.say([d,f,m],e)});g.addResponse("No",function(){h.talkLater()});this.addHelp(g,true);var d=new HelpText("<b>Firefox</b> is a great standards compliant browser from Mozilla that is also free and open source!<br><br>Want to try it?");d.addResponseURL("Yes","http://www.firefox.com");d.addResponse("No",function(){h.say([f,m],e)});this.addHelp(d);var f=new HelpText("<b>Chrome</b> is lightweight fast browser developed by Google!<br><br>Want to try it?");f.addResponseURL("Yes","http://www.google.com/chrome");f.addResponse("No",function(){h.say([d,m],e)});this.addHelp(f);var m=new HelpText("<b>Opera</b> is a browser focused on speed and memory usage.  Lots of people like it.<br><br>Want to give it a try?");m.addResponseURL("Yes","http://www.opera.com");m.addResponse("No",function(){h.say([d,f],e)});this.addHelp(m);var e=new HelpText("I hope you change your mind someday!");e.addTimeout(1000,function(){h.closeBubble()});this.addHelp(e);var l=new HelpText("Ouch!",true);l.addTimeout(1000,function(){h.closeBubble()});this.addHelp(l);var k=new HelpText("Ahhh My Face!!",true);k.addTimeout(1000,function(){h.closeBubble()});this.addHelp(k);var i=new HelpText("Don't hurt me no more!",true);i.addTimeout(1000,function(){h.closeBubble()});this.addHelp(i);this.talkLater(2000)};Clippy.prototype.addHelp=function(a,b){this.help[a.getKey()]=a;if(b){this.firstlines.push(a.getKey())}return};Clippy.prototype.sayOne=function(d,b){var e=false,c=0;while(c<d.length){var a=parseInt(Math.random()*d.length);if(this.canSay(d[a])){this.say(d[a]);return}c++}if(b){this.say(b)}return};Clippy.prototype.canSay=function(a){return this.help[a].available()};Clippy.prototype.say=function(b,a){if(this.timer!=false){try{clearTimeout(this.timer);this.timer=false}catch(c){}}if(typeof(b)!=="string"&&b.length){this.sayOne(b,a)}if(this.help[b]){this.openBubble(this.help[b].toElements())}};Clippy.prototype.firstLine=function(){this.sayOne(this.firstlines)};Clippy.prototype.talkLater=function(b){this.closeBubble();var a=this;this.timer=setTimeout(function(){a.firstLine()},b?b:(Math.random()*3000+500))};Clippy.prototype.openBubble=function(a){if(typeof(a)=="string"){var b=document.createElement("p");b.innerHTML=a}else{var b=a}if(this.bubble){this.bubble.close()}this.bubble=new PopupDisplay(b,{file_dir:this.file_dir});this.homebase.appendChild(this.bubble.getElement())};Clippy.prototype.closeBubble=function(){if(this.bubble){this.bubble.close()}};Clippy.prototype.update=function(){this.update_count++};Clippy.prototype.move=function(a,b){this.character.move(a,b)};