(function(c){function d(h){var i=h;if(!document.getElementsByTagName("body")[0]){setTimeout(function(){d(i)},10)}else{i()}}var f={base:"_",cur:0,get:function(){this.cur++;return this.base+this.cur}};var b=function(h,i){this.question=h;this.options=[];this.key=f.get();this.views=0;this.reusable=(i===true);this.timeout={};return this};b.prototype.available=function(){return(this.views<1||this.reusable===true)};b.prototype.addResponseURL=function(i,h){this.options.push({text:i,URL:h,rel:"external"});return};b.prototype.addResponse=function(i,h){this.options.push({text:i,callback:h,rel:"internal"});return};b.prototype.addTimeout=function(i,h){this.timeout={callback:h,timeout:i}};b.prototype.getKey=function(){return this.key};b.prototype.toString=function(){return this.question};b.prototype.toString=function(){return this.getKey()};b.prototype.toElements=function(){this.views++;var m=document.createElement("div");var l=document.createElement("p");l.innerHTML=this.question;m.appendChild(l);for(var j=0;j<this.options.length;j++){var h=document.createElement("button");h.innerHTML=this.options[j].text;if(this.options[j].rel=="internal"){h.onclick=this.options[j].callback}else{var k=this.options[j];h.onclick=function(){c.location=k.URL}}m.appendChild(h)}if(this.timeout.callback&&typeof(this.timeout.callback)=="function"){setTimeout(this.timeout.callback,(this.timeout.timeout?this.timeout.timeout:500))}return m};var g=function(i){this.file_dir=(i.file_dir)?i.file_dir:"";this.div=document.createElement("div");this.div.style.zIndex=1000000;this.div.style.width="102px";this.div.style.height="98px";this.div.style.backgroundColor="transparent";this.div.style.position="absolute";this.div.style.bottom=0;this.div.style.color="black";this.div.style.right="60px";this.div.style.display="block";var h=new Image();h.src=this.file_dir+"clippy-main.png";h.style.position="relative";h.style.display="block";this.div.appendChild(h);this.div.style.opacity=(i.visible===false)?0:1;if(i.click&&typeof(i.click)=="function"){h.onclick=i.click}return this};g.prototype.getElement=function(){return this.div||null};g.prototype.getPosition=function(){return{bottom:this.div.style.bottom,right:this.div.style.right}};g.prototype.fadeIn=function(i,h){var j=this;if(!h){h={}}if(!h.step){h.step=1/200}if(!h.value){h.value=0}if(!h.remain){h.remain=200}if(!h.increment){h.increment=i/200}h.remain--;h.value+=h.step;j.div.style.opacity=h.value;if(h.remain>0){setTimeout(function(){j.fadeIn(i,h)},h.increment)}return};g.prototype.move=function(h,i){this.div.style.bottom=(parseInt(this.div.style.top)+h)+"px";this.div.style.right=(parseInt(this.div.style.left)+i)+"px"};var a=function(k,i){this.file_dir=(i.file_dir)?i.file_dir:"";if(typeof(k)==="string"){p=document.createElement("p");p.innerHTML=k;k=p}this.div=document.createElement("div");this.div.style.zIndex=1000000;this.div.style.width="130px";this.div.style.height="auto";this.div.style.backgroundColor="transparent";this.div.style.color="black";this.div.style.position="absolute";this.div.style.bottom="85px";this.div.style.right="55px";this.div.style.display="block";var j=new Image();j.src=this.file_dir+"clippy-speech-top.png";j.style.position="relative";j.style.display="block";this.div.appendChild(j);this.message=document.createElement("div");this.message.style.background="transparent url('"+this.file_dir+"clippy-speech-mid.png') top left repeat-y";this.message.style.padding="8px";this.message.style.font="11.5px Arial, Verdana, Sans";this.message.appendChild(k);this.div.appendChild(this.message);var h=new Image();h.src=this.file_dir+"clippy-speech-bottom.png";h.style.position="relative";h.style.display="block";this.div.appendChild(h);return this};a.prototype.close=function(){try{var i=this.getElement();if(i!=null&&i.parentNode){i=i.parentNode;i.removeChild(this.getElement())}}catch(h){}};a.prototype.getElement=function(){return this.div};var e=function(i,h){this.help={};this.firstlines=[];this.homebase=this.findHomeBase(i);this.timer=false;this.timer_interval=200;this.update_count=0;this.file_dir=(h)?h:"";this.preload();return this};e.prototype.preload=function(){var j=["clippy-main.png","clippy-speech-top.png","clippy-speech-mid.png","clippy-speech-bottom.png"];var h=[];for(var k in j){h[k]=new Image();h[k].onload=function(){console.log("loaded"+this.src)};h[k].src=this.file_dir+j[k]}};e.prototype.findHomeBase=function(h){if(!h){h="body"}h+="";var i=false;if((h).substr(0,1)=="#"){i=document.getElementById(h.substr(1,h.length));var j=document.createElement("div");j.style.position="relative";i.appendChild(j);return j}else{i=document.getElementsByTagName(h)[0];var j=document.createElement("div");j.style.zIndex=9999999;j.style.width="300px";j.style.height="300px";j.style.backgroundColor="transparent";j.style.position="fixed";j.style.bottom="0";j.style.right="0";i.appendChild(j);return j}return i};e.prototype.run=function(i){if(!(i&&i.override&&i.override==true)){if(!(/MSIE 6/i.test(navigator.userAgent))){return false}}var o=this;this.character=new g({click:function(){o.say([t,s,q]);o.move(parseInt(Math.random()*20+-20),parseInt(Math.random()*20+-20))},file_dir:this.file_dir,visible:false});this.homebase.appendChild(this.character.getElement());this.character.fadeIn(1000);var r=new b("I see you're trying to <i>use the internet.</i>  Would you like a friendly suggestion to make your browsing experience a more enjoyable and secure?");r.addResponse("Yes",function(){o.say([k,m,u],l)});r.addResponse("No",function(){o.talkLater()});this.addHelp(r,true);var j=new b("I see you're still <i>using IE6.</i>  That browser was released back in 2001, when strange beasts roamed the earth.<br><br>Would you like some upgrade suggestions?");j.addResponse("Yes",function(){o.say([k,m,u],l)});j.addResponse("No",function(){o.talkLater()});this.addHelp(j,true);var h=new b("Your current browser is out of date.<br><br>Can I show you some alternatives you might like better?");h.addResponse("Yes",function(){o.say([k,m,u],l)});h.addResponse("No",function(){o.talkLater()});this.addHelp(h,true);var n=new b("Would you like to try a more modern browser?");n.addResponse("Yes",function(){o.say([k,m,u],l)});n.addResponse("No",function(){o.talkLater()});this.addHelp(n,true);var k=new b("<b>Firefox</b> is a great standards compliant browser from Mozilla that is also free and open source!<br><br>Want to try it?");k.addResponseURL("Yes","http://www.firefox.com");k.addResponse("No",function(){o.say([m,u],l)});this.addHelp(k);var m=new b("<b>Chrome</b> is lightweight fast browser developed by Google!<br><br>Want to try it?");m.addResponseURL("Yes","http://www.google.com/chrome");m.addResponse("No",function(){o.say([k,u],l)});this.addHelp(m);var u=new b("<b>Opera</b> is a browser focused on speed and memory usage.  Lots of people like it.<br><br>Want to give it a try?");u.addResponseURL("Yes","http://www.opera.com");u.addResponse("No",function(){o.say([k,m],l)});this.addHelp(u);var l=new b("I hope you change your mind someday!");l.addTimeout(1000,function(){o.closeBubble()});this.addHelp(l);var t=new b("Ouch!",true);t.addTimeout(1000,function(){o.closeBubble()});this.addHelp(t);var s=new b("Ahhh My Face!!",true);s.addTimeout(1000,function(){o.closeBubble()});this.addHelp(s);var q=new b("Don't hurt me no more!",true);q.addTimeout(1000,function(){o.closeBubble()});this.addHelp(q);this.talkLater(2000)};e.prototype.addHelp=function(h,i){this.help[h.getKey()]=h;if(i){this.firstlines.push(h.getKey())}return};e.prototype.sayOne=function(k,i){var l=false,j=0;while(j<k.length){var h=parseInt(Math.random()*k.length);if(this.canSay(k[h])){this.say(k[h]);return}j++}if(i){this.say(i)}return};e.prototype.canSay=function(h){return this.help[h].available()};e.prototype.say=function(i,h){if(this.timer!=false){try{clearTimeout(this.timer);this.timer=false}catch(j){}}if(typeof(i)!=="string"&&i.length){this.sayOne(i,h)}if(this.help[i]){this.openBubble(this.help[i].toElements())}};e.prototype.firstLine=function(){this.sayOne(this.firstlines)};e.prototype.talkLater=function(i){this.closeBubble();var h=this;this.timer=setTimeout(function(){h.firstLine()},i?i:(Math.random()*3000+500))};e.prototype.openBubble=function(h){if(typeof(h)=="string"){var i=document.createElement("p");i.innerHTML=h}else{var i=h}if(this.bubble){this.bubble.close()}this.bubble=new a(i,{file_dir:this.file_dir});this.homebase.appendChild(this.bubble.getElement())};e.prototype.closeBubble=function(){if(this.bubble){this.bubble.close()}};e.prototype.update=function(){this.update_count++};e.prototype.move=function(h,i){this.character.move(h,i)};c.Clippy=e;c.__clippyboot=d})(window);